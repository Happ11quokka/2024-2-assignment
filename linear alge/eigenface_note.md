# SVD (Singular Value Decomposition) & Eigenface 정리

## 1. SVD (Singular Value Decomposition)

### 1.1 기본 아이디어

- **SVD**는 직사각 행렬(비정방 행렬)에 대해 **특이값(singular value)**과 **특이벡터(singular vector)**를 찾는 과정입니다.
- 정방 행렬의 경우 **고유값(eigenvalue)**, **고유벡터(eigenvector)**를 찾는 것과 유사하지만, 그 아이디어가 직사각 행렬로 확장된 형태라고 볼 수 있습니다.

### 1.2 방법 (How?)

1. 크기가 \(m \times n\)인 행렬 \(A\)에 대해,  
   \[
   A^T A
   \]
   (크기 \(n \times n\))를 구한다.

2. \(A^T A\)의 **고유값** \(\lambda\)와 **고유벡터** \(\mathbf{v}\)를 구한다.

   - 일반적으로 \(\lambda \ge 0\)이 됨.

3. **특이값** \(\sigma\)는  
   \[
   \sigma = \sqrt{\lambda}
   \]
   로 정의한다.

4. **특이벡터** \(\mathbf{u}\_i\)는  
   \[
   \mathbf{u}\_i \;=\; \frac{1}{\sigma_i}\,A\,\mathbf{v}\_i
   \]
   의 형태로 구할 수 있다.

5. 최종적으로, **SVD**는  
   \[
   A = U \,\Sigma\, V^T
   \]
   로 표현된다. (복소 행렬인 경우 \(V^H\) 사용)

   - \(U\)는 \(m \times m\) 직교(또는 유니터리) 행렬
   - \(\Sigma\)는 \(m \times n\) 크기의 대각(또는 준대각) 형태인 특이값 행렬
   - \(V\)는 \(n \times n\) 직교(유니터리) 행렬

#### (해석)

- \(U\)의 열벡터(\(\mathbf{u}\_1, \dots, \mathbf{u}\_m\))는 \(\mathcal{C}(A)\)와 \(\mathcal{N}(A^T)\)를 기준으로 한 **기저** 역할을 함.
- \(V\)의 열벡터(\(\mathbf{v}\_1, \dots, \mathbf{v}\_n\))는 \(\mathcal{C}(A^T)\)와 \(\mathcal{N}(A)\)를 기준으로 한 **기저** 역할을 함.
- \(\Sigma\)의 대각원소(\(\sigma_1, \sigma_2, \dots\))가 **특이값**이며, \(\sigma_i = \sqrt{\lambda_i(A^T A)}\).

---

## 2. About eigenvector \(\mathbf{v}\)

- \(A^T A\)는 **대칭 행렬(또는 에르미트 행렬)**이므로, 그 **고유벡터들은 서로 직교(orthonormal)** 관계를 이룬다.
- 즉, \(\mathbf{v}\_i\)들은 서로 직교하는 **표준 정규 직교기저**가 될 수 있다.

---

## 3. About eigenvalue \(\lambda\)

- 각각의 고유벡터 \(\mathbf{v}\_i\)에 대응하는 고유값 \(\lambda_i\)는, 그 고유벡터가 갖는 **가중치(중요도)** 역할을 한다.
- **SVD**에서는 \(\sigma_i = \sqrt{\lambda_i}\)가 **특이값**으로 사용되어, 행렬 \(A\)의 중요한 방향(기저)을 나타내게 됨.

---

## 4. Eigenface’s basis (예시: 얼굴 인식 등의 응용)

### 4.1 기본 아이디어

- 어떤 이미지(예: \(F_k\))를 **벡터(vector)** 형태로 펼친 뒤(2D → 1D), **평균 얼굴(벡터)** \(M\)을 빼서 정규화된 벡터 \(F_k - M\)을 만든다.
- 이를 **행렬 \(A\)**의 열벡터(또는 행)에 모아서, **여러 얼굴 이미지**의 정보를 담은 큰 행렬 \(A\)를 구성한다.

예를 들어, 다음과 같이 구성할 수 있다:
\[
A =
\begin{pmatrix}
a_1^T \\
a_2^T \\
\vdots \\
a_n^T
\end{pmatrix}
\]
여기서 각 \(a_k\)는 (해당 이미지를 벡터화한 뒤) 평균 \(\,M\)을 뺀 형태.

### 4.2 SVD를 이용한 기본 벡터(기저) 찾기

- \(A^T\)가 만드는 공간(\(\mathcal{C}(A^T)\))의 **직교정규 기저**가 곧 **Eigenface(고유 얼굴)** 기저가 된다.
- 예컨대 \(v_1, v_2, \dots, v_n\) (또는 필요에 따라 \(v_1, \dots, v_r\))는 각 얼굴들의 **대표 모양**을 나타내는 축(기저)로 볼 수 있음.
- \(n\)장 이미지가 있다면, 최대 \(n\)개의 기저 벡터를 얻을 수 있다.

### 4.3 재구성(Reconstruct)

- 임의의 새로운 얼굴벡터 \(\mathbf{b}\) (이미 평균을 뺀 상태)가 있다고 할 때,
  \[
  \mathbf{b} \;=\; c_1 \mathbf{v}\_1 + c_2 \mathbf{v}\_2 + \cdots + c_r \mathbf{v}\_r
  \]
  처럼, **고유얼굴 벡터** \(\mathbf{v}\_i\)들의 선형결합으로 표현 가능하다.  
  (직교정규이므로 내적을 통해 계수 \(c_i\)를 쉽게 구한다.)

- 이를 통해 **이미지(얼굴)의 압축/재구성**이 가능하며, 분류나 인식 등 다양한 응용에 활용할 수 있다.

---

## 요약

1. **SVD**: 행렬 \(A\)를
   \[
   A = U \,\Sigma\, V^T
   \]
   로 분해한다.

   - 직사각행렬에서도 **특이값**과 **특이벡터**를 이용해 차원 축소 또는 중요한 방향(기저) 추출이 가능.

2. 고유벡터(\(\mathbf{v}\_i\))는 **서로 직교정규(orthonormal)**이며, 각 \(\sigma_i\)는 \(\mathbf{v}\_i\)에 대응하는 **가중치(중요도)**.

3. **Eigenface**: 여러 얼굴 이미지를 벡터화 후 평균 얼굴을 뺀 뒤, SVD를 적용해 얻은 **고유얼굴 기저**를 사용.
   - 이미지 **재구성** 및 **얼굴 인식** 등에 매우 유용.

필요에 따라 위 내용 중 일부를 **발췌**하여 활용하시면 됩니다.
